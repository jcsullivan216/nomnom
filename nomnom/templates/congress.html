{% extends "base.html" %}

{% block title %}Congressional Trading{% endblock %}

{% block extra_styles %}
<style>
    .congress-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .congress-stat {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 24px;
        text-align: center;
    }

    .congress-stat-value {
        font-size: 2rem;
        font-weight: 700;
    }

    .congress-stat-label {
        color: var(--text-secondary);
        margin-top: 8px;
        font-size: 0.9rem;
    }

    .trade-row {
        display: grid;
        grid-template-columns: 1fr auto auto auto auto auto;
        gap: 20px;
        align-items: center;
        padding: 20px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        margin-bottom: 12px;
        transition: transform 0.2s;
    }

    .trade-row:hover {
        transform: translateX(4px);
        border-color: var(--accent-blue);
    }

    .trade-row.unusual {
        border-left: 4px solid var(--accent-yellow);
    }

    .politician-info {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .politician-name {
        font-weight: 600;
        font-size: 1.1rem;
    }

    .politician-meta {
        display: flex;
        gap: 10px;
        font-size: 0.85rem;
        color: var(--text-secondary);
    }

    .party-badge {
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: 600;
        font-size: 0.8rem;
    }

    .party-d {
        background: rgba(88, 166, 255, 0.2);
        color: var(--accent-blue);
    }

    .party-r {
        background: rgba(248, 81, 73, 0.2);
        color: var(--accent-red);
    }

    .ticker-cell {
        text-align: center;
    }

    .ticker {
        font-family: monospace;
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--accent-blue);
        padding: 6px 12px;
        background: rgba(88, 166, 255, 0.1);
        border-radius: 6px;
    }

    .trade-type-cell {
        text-align: center;
    }

    .trade-type {
        padding: 6px 16px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.9rem;
    }

    .trade-buy {
        background: rgba(63, 185, 80, 0.15);
        color: var(--accent-green);
    }

    .trade-sell {
        background: rgba(248, 81, 73, 0.15);
        color: var(--accent-red);
    }

    .amount-cell {
        text-align: right;
    }

    .amount {
        font-size: 1.1rem;
        font-weight: 600;
    }

    .amount-large {
        color: var(--accent-yellow);
    }

    .date-cell {
        text-align: center;
        color: var(--text-secondary);
    }

    .delay-cell {
        text-align: center;
    }

    .delay {
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.85rem;
    }

    .delay-fast {
        background: rgba(210, 153, 34, 0.2);
        color: var(--accent-yellow);
    }

    .delay-normal {
        background: var(--bg-hover);
        color: var(--text-secondary);
    }

    .unusual-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        background: rgba(210, 153, 34, 0.15);
        color: var(--accent-yellow);
        border-radius: 4px;
        font-size: 0.8rem;
        margin-left: 10px;
    }

    .filter-bar {
        display: flex;
        gap: 12px;
        margin-bottom: 24px;
        flex-wrap: wrap;
    }

    .filter-btn {
        padding: 8px 16px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 6px;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.2s;
    }

    .filter-btn:hover,
    .filter-btn.active {
        background: var(--accent-blue);
        color: white;
        border-color: var(--accent-blue);
    }

    @media (max-width: 900px) {
        .trade-row {
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .politician-info {
            grid-column: 1 / -1;
        }
    }

    @media (max-width: 500px) {
        .trade-row {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>&#127963;&#65039; Congressional Trading</h1>
    <p>Recent stock trades by members of Congress - potential policy-correlated signals</p>
</div>

<div class="congress-summary">
    <div class="congress-stat">
        <div class="congress-stat-value">{{ trades|length }}</div>
        <div class="congress-stat-label">Total Trades</div>
    </div>
    <div class="congress-stat">
        <div class="congress-stat-value" style="color: var(--accent-green);">
            {{ trades|selectattr('is_buy')|list|length }}
        </div>
        <div class="congress-stat-label">Buy Orders</div>
    </div>
    <div class="congress-stat">
        <div class="congress-stat-value" style="color: var(--accent-red);">
            {{ trades|rejectattr('is_buy')|list|length }}
        </div>
        <div class="congress-stat-label">Sell Orders</div>
    </div>
    <div class="congress-stat">
        <div class="congress-stat-value" style="color: var(--accent-yellow);">
            {{ trades|selectattr('is_unusual')|list|length }}
        </div>
        <div class="congress-stat-label">Unusual Trades</div>
    </div>
</div>

<div class="disclaimer">
    <strong>&#128161; Why This Matters</strong>
    Research shows congressional portfolios historically outperform the market.
    Committee members trading in sectors they regulate may have policy insights.
    Quick disclosures or large trades can signal time-sensitive information.
</div>

{% for trade in trades %}
<div class="trade-row {% if trade.is_unusual %}unusual{% endif %}">
    <div class="politician-info">
        <span class="politician-name">
            {{ trade.politician }}
            {% if trade.is_unusual %}
            <span class="unusual-badge">&#9888;&#65039; Unusual</span>
            {% endif %}
        </span>
        <span class="politician-meta">
            <span class="party-badge party-{{ trade.party|lower }}">{{ trade.party }}</span>
            <span>{{ trade.chamber }}</span>
            <span>{{ trade.state }}</span>
        </span>
    </div>

    <div class="ticker-cell">
        <span class="ticker">{{ trade.ticker }}</span>
    </div>

    <div class="trade-type-cell">
        <span class="trade-type {% if trade.is_buy %}trade-buy{% else %}trade-sell{% endif %}">
            {{ trade.trade_type|upper }}
        </span>
    </div>

    <div class="amount-cell">
        <span class="amount {% if trade.amount_raw >= 100000 %}amount-large{% endif %}">
            {{ trade.amount }}
        </span>
    </div>

    <div class="date-cell">
        {{ trade.trade_date }}
    </div>

    <div class="delay-cell">
        <span class="delay {% if trade.disclosure_delay <= 3 %}delay-fast{% else %}delay-normal{% endif %}">
            {{ trade.disclosure_delay }}d delay
        </span>
    </div>
</div>
{% else %}
<div class="card" style="text-align: center; padding: 60px;">
    <h3 style="color: var(--text-secondary);">No trades found</h3>
</div>
{% endfor %}
{% endblock %}
